<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SQL Statements for creating the Database &#8212; Technical Description of JCRdb (Jena Clinical Research Database) v1.0  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=039e1c02" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=b3ba4146"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CQL - Descriptions and example rules" href="TechnicalDetails_Appendix_CQL.html" />
    <link rel="prev" title="Concepts predefined in the database" href="TechnicalDetails_Appendix_Concepts.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="sql-statements-for-creating-the-database">
<h1>SQL Statements for creating the Database<a class="headerlink" href="#sql-statements-for-creating-the-database" title="Permalink to this heading">Â¶</a></h1>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">BEGIN</span><span class="w"> </span><span class="k">TRANSACTION</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;VISIT_DIMENSION&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;VISIT_DIMENSION&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;ENCOUNTER_NUM&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;PATIENT_NUM&quot;</span><span class="w">   </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;ACTIVE_STATUS_CD&quot;</span><span class="w">      </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;START_DATE&quot;</span><span class="w">    </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;END_DATE&quot;</span><span class="w">      </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;INOUT_CD&quot;</span><span class="w">      </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;LOCATION_CD&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;VISIT_BLOB&quot;</span><span class="w">    </span><span class="nb">BLOB</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPDATE_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;DOWNLOAD_DATE&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;IMPORT_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;SOURCESYSTEM_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPLOAD_ID&quot;</span><span class="w">     </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;ENCOUNTER_NUM&quot;</span><span class="w"> </span><span class="n">AUTOINCREMENT</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;CONCEPT_DIMENSION&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;CONCEPT_DIMENSION&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;CONCEPT_PATH&quot;</span><span class="w">  </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CONCEPT_CD&quot;</span><span class="w">    </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;NAME_CHAR&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;VALTYPE_CD&quot;</span><span class="w">    </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UNIT_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;RELATED_CONCEPT&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CONCEPT_BLOB&quot;</span><span class="w">  </span><span class="nb">BLOB</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPDATE_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;DOWNLOAD_DATE&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;IMPORT_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;SOURCESYSTEM_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPLOAD_ID&quot;</span><span class="w">     </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;CONCEPT_CD&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;OBSERVATION_FACT&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;OBSERVATION_FACT&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;OBSERVATION_ID&quot;</span><span class="w">        </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;ENCOUNTER_NUM&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;PATIENT_NUM&quot;</span><span class="w">   </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CATEGORY_CHAR&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CONCEPT_CD&quot;</span><span class="w">    </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;PROVIDER_ID&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;START_DATE&quot;</span><span class="w">    </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;INSTANCE_NUM&quot;</span><span class="w">  </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;VALTYPE_CD&quot;</span><span class="w">    </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;TVAL_CHAR&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;NVAL_NUM&quot;</span><span class="w">      </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;VALUEFLAG_CD&quot;</span><span class="w">  </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;QUANTITY_NUM&quot;</span><span class="w">  </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UNIT_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;END_DATE&quot;</span><span class="w">      </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;LOCATION_CD&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CONFIDENCE_NUM&quot;</span><span class="w">        </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;OBSERVATION_BLOB&quot;</span><span class="w">      </span><span class="nb">BLOB</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPDATE_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;DOWNLOAD_DATE&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;IMPORT_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;SOURCESYSTEM_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPLOAD_ID&quot;</span><span class="w">     </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;OBSERVATION_ID&quot;</span><span class="w"> </span><span class="n">AUTOINCREMENT</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;CONCEPT_CD&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;CONCEPT_DIMENSION&quot;</span><span class="p">(</span><span class="ss">&quot;CONCEPT_CD&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">NO</span><span class="w"> </span><span class="n">ACTION</span><span class="p">,</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;ENCOUNTER_NUM&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;VISIT_DIMENSION&quot;</span><span class="p">(</span><span class="ss">&quot;ENCOUNTER_NUM&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">NO</span><span class="w"> </span><span class="n">ACTION</span><span class="p">,</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;PATIENT_NUM&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;PATIENT_DIMENSION&quot;</span><span class="p">(</span><span class="ss">&quot;PATIENT_NUM&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">NO</span><span class="w"> </span><span class="n">ACTION</span>
<span class="p">);</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;CONCEPT_CQL_LOOKUP&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;CONCEPT_CQL_LOOKUP&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;CONCEPT_CQL_ID&quot;</span><span class="w">        </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CONCEPT_CD&quot;</span><span class="w">    </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CQL_ID&quot;</span><span class="w">        </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;NAME_CHAR&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;RULE_BLOB&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPDATE_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;DOWNLOAD_DATE&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;IMPORT_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPLOAD_ID&quot;</span><span class="w">     </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;CONCEPT_CQL_ID&quot;</span><span class="w"> </span><span class="n">AUTOINCREMENT</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;CONCEPT_CD&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;CONCEPT_DIMENSION&quot;</span><span class="p">(</span><span class="ss">&quot;CONCEPT_CD&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;CQL_ID&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;CQL_FACT&quot;</span><span class="p">(</span><span class="ss">&quot;CQL_ID&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;NOTE_FACT&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;NOTE_FACT&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;NOTE_ID&quot;</span><span class="w">       </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CATEGORY_CHAR&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;NAME_CHAR&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;NOTE_BLOB&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPDATE_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;DOWNLOAD_DATE&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;IMPORT_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPLOAD_ID&quot;</span><span class="w">     </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;NOTE_ID&quot;</span><span class="w"> </span><span class="n">AUTOINCREMENT</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;CQL_FACT&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;CQL_FACT&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;CQL_ID&quot;</span><span class="w">        </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CODE_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;NAME_CHAR&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CQL_CHAR&quot;</span><span class="w">      </span><span class="nb">BLOB</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;JSON_CHAR&quot;</span><span class="w">     </span><span class="nb">BLOB</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CQL_BLOB&quot;</span><span class="w">      </span><span class="nb">BLOB</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPDATE_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;IMPORT_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;DOWNLOAD_DATE&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPLOAD_ID&quot;</span><span class="w">     </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;CQL_ID&quot;</span><span class="w"> </span><span class="n">AUTOINCREMENT</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;PROVIDER_DIMENSION&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;PROVIDER_DIMENSION&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;PROVIDER_ID&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;PROVIDER_PATH&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;NAME_CHAR&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CONCEPT_BLOB&quot;</span><span class="w">  </span><span class="nb">BLOB</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPDATE_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;DOWNLOAD_DATE&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;IMPORT_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;SOURCESYSTEM_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPLOAD_ID&quot;</span><span class="w">     </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;PROVIDER_ID&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;USER_PATIENT_LOOKUP&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;USER_PATIENT_LOOKUP&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;USER_PATIENT_ID&quot;</span><span class="w">       </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;USER_ID&quot;</span><span class="w">       </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;PATIENT_NUM&quot;</span><span class="w">   </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;NAME_CHAR&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;USER_PATIENT_BLOB&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPDATE_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;DOWNLOAD_DATE&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;IMPORT_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPLOAD_ID&quot;</span><span class="w">     </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;USER_PATIENT_ID&quot;</span><span class="w"> </span><span class="n">AUTOINCREMENT</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;PATIENT_NUM&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;PATIENT_DIMENSION&quot;</span><span class="p">(</span><span class="ss">&quot;PATIENT_NUM&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;USER_ID&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;USER_MANAGEMENT&quot;</span><span class="p">(</span><span class="ss">&quot;USER_ID&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;USER_MANAGEMENT&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;USER_MANAGEMENT&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;USER_ID&quot;</span><span class="w">       </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;COLUMN_CD&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;USER_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;NAME_CHAR&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;PASSWORD_CHAR&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;USER_BLOB&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPDATE_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;DOWNLOAD_DATE&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;IMPORT_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPLOAD_ID&quot;</span><span class="w">     </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;USER_ID&quot;</span><span class="w"> </span><span class="n">AUTOINCREMENT</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;PATIENT_DIMENSION&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;PATIENT_DIMENSION&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;PATIENT_NUM&quot;</span><span class="w">   </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;PATIENT_CD&quot;</span><span class="w">    </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;VITAL_STATUS_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;BIRTH_DATE&quot;</span><span class="w">    </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;DEATH_DATE&quot;</span><span class="w">    </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;AGE_IN_YEARS&quot;</span><span class="w">  </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;SEX_CD&quot;</span><span class="w">        </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;LANGUAGE_CD&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;RACE_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;MARITAL_STATUS_CD&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;RELIGION_CD&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;STATECITYZIP_PATH&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;PATIENT_BLOB&quot;</span><span class="w">  </span><span class="nb">BLOB</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPDATE_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;DOWNLOAD_DATE&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;IMPORT_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;SOURCESYSTEM_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPLOAD_ID&quot;</span><span class="w">     </span><span class="nb">NUMERIC</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;PATIENT_NUM&quot;</span><span class="w"> </span><span class="n">AUTOINCREMENT</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;CODE_LOOKUP&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;CODE_LOOKUP&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;TABLE_CD&quot;</span><span class="w">      </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;COLUMN_CD&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;CODE_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;NAME_CHAR&quot;</span><span class="w">     </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;LOOKUP_BLOB&quot;</span><span class="w">   </span><span class="nb">BLOB</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPDATE_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;DOWNLOAD_DATE&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;IMPORT_DATE&quot;</span><span class="w">   </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;SOURCESYSTEM_CD&quot;</span><span class="w">       </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;UPLOAD_ID&quot;</span><span class="w">     </span><span class="nb">NUMERIC</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="ss">&quot;CODE_CD&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- TRIGGER</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;delete_patient_cascade&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="p">[</span><span class="n">delete_patient_cascade</span><span class="p">]</span>
<span class="k">BEFORE</span><span class="w"> </span><span class="k">DELETE</span>
<span class="k">ON</span><span class="w"> </span><span class="p">[</span><span class="n">PATIENT_DIMENSION</span><span class="p">]</span>
<span class="k">FOR</span><span class="w"> </span><span class="k">EACH</span><span class="w"> </span><span class="k">ROW</span>
<span class="k">BEGIN</span>
<span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">VISIT_DIMENSION</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">VISIT_DIMENSION</span><span class="p">.</span><span class="n">PATIENT_NUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">old</span><span class="p">.</span><span class="n">PATIENT_NUM</span><span class="p">;</span>
<span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">USER_PATIENT_LOOKUP</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">USER_PATIENT_LOOKUP</span><span class="p">.</span><span class="n">PATIENT_NUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">old</span><span class="p">.</span><span class="n">PATIENT_NUM</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;delete_visit_cascade&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="p">[</span><span class="n">delete_visit_cascade</span><span class="p">]</span>
<span class="k">BEFORE</span><span class="w"> </span><span class="k">DELETE</span>
<span class="k">ON</span><span class="w"> </span><span class="p">[</span><span class="n">VISIT_DIMENSION</span><span class="p">]</span>
<span class="k">FOR</span><span class="w"> </span><span class="k">EACH</span><span class="w"> </span><span class="k">ROW</span>
<span class="k">BEGIN</span>
<span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">OBSERVATION_FACT</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">ENCOUNTER_NUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">old</span><span class="p">.</span><span class="n">ENCOUNTER_NUM</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;delete_concept_cql_lookup&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="p">[</span><span class="n">delete_concept_cql_lookup</span><span class="p">]</span>
<span class="k">BEFORE</span><span class="w"> </span><span class="k">DELETE</span>
<span class="k">ON</span><span class="w"> </span><span class="p">[</span><span class="n">CQL_FACT</span><span class="p">]</span>
<span class="k">FOR</span><span class="w"> </span><span class="k">EACH</span><span class="w"> </span><span class="k">ROW</span>
<span class="k">BEGIN</span>
<span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">CONCEPT_CQL_LOOKUP</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">CONCEPT_CQL_LOOKUP</span><span class="p">.</span><span class="n">CQL_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">old</span><span class="p">.</span><span class="n">CQL_ID</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>

<span class="c1">-- VIEWS</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;patient_observations&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">patient_observations</span>
<span class="k">AS</span>

<span class="k">SELECT</span>
<span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">PATIENT_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">PATIENT_CD</span><span class="p">,</span>
<span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">PATIENT_NUM</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">PATIENT_NUM</span><span class="p">,</span>
<span class="n">USER_PATIENT_LOOKUP</span><span class="p">.</span><span class="n">USER_ID</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">USER_ID</span><span class="p">,</span>
<span class="n">VISIT_DIMENSION</span><span class="p">.</span><span class="n">ENCOUNTER_NUM</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ENCOUNTER_NUM</span><span class="p">,</span>
<span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">START_DATE</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">START_DATE</span><span class="p">,</span>
<span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">OBSERVATION_ID</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">OBSERVATION_ID</span><span class="p">,</span>
<span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">CATEGORY_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">CATEGORY_CHAR</span><span class="p">,</span>
<span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">CONCEPT_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">CONCEPT_CD</span><span class="p">,</span>
<span class="n">CD1</span><span class="p">.</span><span class="n">NAME_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">CONCEPT_NAME_CHAR</span><span class="p">,</span>
<span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">VALTYPE_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">VALTYPE_CD</span><span class="p">,</span>
<span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">NVAL_NUM</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">NVAL_NUM</span><span class="p">,</span>
<span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">UNIT_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">UNIT_CD</span><span class="p">,</span>
<span class="n">CD3</span><span class="p">.</span><span class="n">NAME_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">UNIT_RESOLVED</span><span class="p">,</span>
<span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">TVAL_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">TVAL_CHAR</span><span class="p">,</span>
<span class="n">CD2</span><span class="p">.</span><span class="n">NAME_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">TVAL_RESOLVED</span><span class="p">,</span>
<span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">OBSERVATION_BLOB</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">OBSERVATION_BLOB</span><span class="p">,</span>
<span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">LOCATION_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">LOCATION_CD</span><span class="p">,</span>
<span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">PROVIDER_ID</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">PROVIDER_ID</span>

<span class="k">FROM</span>
<span class="w">    </span><span class="n">OBSERVATION_FACT</span>

<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">PATIENT_DIMENSION</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">PATIENT_NUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">PATIENT_NUM</span>
<span class="k">INNER</span><span class="w">  </span><span class="k">JOIN</span><span class="w"> </span><span class="n">VISIT_DIMENSION</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">VISIT_DIMENSION</span><span class="p">.</span><span class="n">ENCOUNTER_NUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">ENCOUNTER_NUM</span>
<span class="k">LEFT</span><span class="w">  </span><span class="k">JOIN</span><span class="w"> </span><span class="n">CONCEPT_DIMENSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CD1</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">CD1</span><span class="p">.</span><span class="n">CONCEPT_CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">CONCEPT_CD</span>
<span class="k">LEFT</span><span class="w">  </span><span class="k">JOIN</span><span class="w"> </span><span class="n">CONCEPT_DIMENSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CD2</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">CD2</span><span class="p">.</span><span class="n">CONCEPT_CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">TVAL_CHAR</span>
<span class="k">LEFT</span><span class="w">  </span><span class="k">JOIN</span><span class="w"> </span><span class="n">CONCEPT_DIMENSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CD3</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">CD3</span><span class="p">.</span><span class="n">CONCEPT_CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">UNIT_CD</span>

<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">USER_PATIENT_LOOKUP</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">USER_PATIENT_LOOKUP</span><span class="p">.</span><span class="n">PATIENT_NUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OBSERVATION_FACT</span><span class="p">.</span><span class="n">PATIENT_NUM</span>

<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w">    </span><span class="n">PATIENT_CD</span><span class="p">,</span><span class="w"> </span><span class="n">ENCOUNTER_NUM</span><span class="p">,</span><span class="w"> </span><span class="n">START_DATE</span><span class="p">,</span><span class="w"> </span><span class="n">CONCEPT_NAME_CHAR</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;patient_list&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">patient_list</span>
<span class="k">AS</span>

<span class="k">SELECT</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">PATIENT_NUM</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">PATIENT_NUM</span><span class="p">,</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">PATIENT_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">PATIENT_CD</span><span class="p">,</span>
<span class="w">    </span><span class="n">USER_PATIENT_LOOKUP</span><span class="p">.</span><span class="n">USER_ID</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">USER_ID</span><span class="p">,</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">VITAL_STATUS_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">VITAL_STATUS_CD</span><span class="p">,</span>
<span class="w">    </span><span class="n">CD1</span><span class="p">.</span><span class="n">NAME_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">VITAL_STATUS_RESOLVED</span><span class="p">,</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">BIRTH_DATE</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">BIRTH_DATE</span><span class="p">,</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">SEX_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">SEX_CD</span><span class="p">,</span>
<span class="w">    </span><span class="n">CD2</span><span class="p">.</span><span class="n">NAME_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">SEX_RESOLVED</span><span class="p">,</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">AGE_IN_YEARS</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">AGE_IN_YEARS</span><span class="p">,</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">LANGUAGE_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">LANGUAGE_CD</span><span class="p">,</span>
<span class="w">    </span><span class="n">CD3</span><span class="p">.</span><span class="n">NAME_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">LANGUAGE_RESOLVED</span><span class="p">,</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">RACE_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">RACE_CD</span><span class="p">,</span>
<span class="w">    </span><span class="n">CD4</span><span class="p">.</span><span class="n">NAME_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">RACE_RESOLVED</span><span class="p">,</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">MARITAL_STATUS_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">MARITAL_STATUS_CD</span><span class="p">,</span>
<span class="w">    </span><span class="n">CD5</span><span class="p">.</span><span class="n">NAME_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">MARITAL_STATUS_RESOLVED</span><span class="p">,</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">RELIGION_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">RELIGION_CD</span><span class="p">,</span>
<span class="w">    </span><span class="n">CD6</span><span class="p">.</span><span class="n">NAME_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">RELIGION_RESOLVED</span><span class="p">,</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">STATECITYZIP_PATH</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">STATECITYZIP_PATH</span><span class="p">,</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">PATIENT_BLOB</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">PATIENT_BLOB</span>

<span class="k">FROM</span>
<span class="w">    </span><span class="n">PATIENT_DIMENSION</span>

<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">CONCEPT_DIMENSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CD1</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">CD1</span><span class="p">.</span><span class="n">CONCEPT_CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">VITAL_STATUS_CD</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">CONCEPT_DIMENSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CD2</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">CD2</span><span class="p">.</span><span class="n">CONCEPT_CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">SEX_CD</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">CONCEPT_DIMENSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CD3</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">CD3</span><span class="p">.</span><span class="n">CONCEPT_CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">LANGUAGE_CD</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">CONCEPT_DIMENSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CD4</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">CD4</span><span class="p">.</span><span class="n">CONCEPT_CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">RACE_CD</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">CONCEPT_DIMENSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CD5</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">CD5</span><span class="p">.</span><span class="n">CONCEPT_CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">MARITAL_STATUS_CD</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">CONCEPT_DIMENSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CD6</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">CD6</span><span class="p">.</span><span class="n">CONCEPT_CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">RELIGION_CD</span>

<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">USER_PATIENT_LOOKUP</span><span class="w"> </span><span class="k">ON</span>
<span class="w">        </span><span class="n">USER_PATIENT_LOOKUP</span><span class="p">.</span><span class="n">PATIENT_NUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PATIENT_DIMENSION</span><span class="p">.</span><span class="n">PATIENT_NUM</span>

<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w">    </span><span class="n">PATIENT_CD</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="ss">&quot;cql_concept_list&quot;</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">cql_concept_list</span>
<span class="k">AS</span>

<span class="k">SELECT</span>
<span class="w">    </span><span class="n">CONCEPT_CQL_LOOKUP</span><span class="p">.</span><span class="n">CONCEPT_CQL_ID</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">CONCEPT_CQL_ID</span><span class="p">,</span>
<span class="n">CONCEPT_CQL_LOOKUP</span><span class="p">.</span><span class="n">CQL_ID</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">CQL_ID</span><span class="p">,</span>
<span class="n">CQL_FACT</span><span class="p">.</span><span class="n">CODE_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">CQL_CODE_CD</span><span class="p">,</span>
<span class="n">CQL_FACT</span><span class="p">.</span><span class="n">NAME_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">CQL_NAME_CHAR</span><span class="p">,</span>
<span class="n">CONCEPT_CQL_LOOKUP</span><span class="p">.</span><span class="n">CONCEPT_CD</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">CONCEPT_CD</span><span class="p">,</span>
<span class="n">CONCEPT_DIMENSION</span><span class="p">.</span><span class="n">NAME_CHAR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">CONCEPT_NAME_CHAR</span>

<span class="k">FROM</span>
<span class="w">    </span><span class="n">CONCEPT_CQL_LOOKUP</span>

<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">CONCEPT_DIMENSION</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">CONCEPT_DIMENSION</span><span class="p">.</span><span class="n">CONCEPT_CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CONCEPT_CQL_LOOKUP</span><span class="p">.</span><span class="n">CONCEPT_CD</span>

<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">CQL_FACT</span><span class="w"> </span><span class="k">ON</span>
<span class="w">    </span><span class="n">CQL_FACT</span><span class="p">.</span><span class="n">CQL_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CONCEPT_CQL_LOOKUP</span><span class="p">.</span><span class="n">CQL_ID</span>

<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w">    </span><span class="n">CONCEPT_CD</span><span class="p">;</span>
<span class="k">COMMIT</span><span class="p">;</span>
</pre></div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Technical Description of JCRdb (Jena Clinical Research Database) v1.0</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Content:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="TechnicalDetails.html">Technical Description of JCRdb (Jena Clinical Research Database) v1.0</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="TechnicalDetails.html#motivation">1. Motivation:</a></li>
<li class="toctree-l2"><a class="reference internal" href="TechnicalDetails.html#overview">2. Overview:</a></li>
<li class="toctree-l2"><a class="reference internal" href="TechnicalDetails.html#architecture">3. Architecture:</a></li>
<li class="toctree-l2"><a class="reference internal" href="TechnicalDetails.html#technical-details">4. Technical Details:</a></li>
<li class="toctree-l2"><a class="reference internal" href="TechnicalDetails.html#key-features">5. Key Features:</a></li>
<li class="toctree-l2"><a class="reference internal" href="TechnicalDetails.html#security-and-compliance">6. Security and Compliance:</a></li>
<li class="toctree-l2"><a class="reference internal" href="TechnicalDetails.html#integration-extensibility">7. Integration &amp; Extensibility:</a></li>
<li class="toctree-l2"><a class="reference internal" href="TechnicalDetails.html#testing-validation">8. Testing &amp; Validation:</a></li>
<li class="toctree-l2"><a class="reference internal" href="TechnicalDetails.html#conclusion-future-work">9. Conclusion &amp; Future Work:</a></li>
<li class="toctree-l2"><a class="reference internal" href="TechnicalDetails.html#acknowledgements">10. Acknowledgements:</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="TechnicalDetails.html#appendix">11. Appendix:</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="TechnicalDetails.html">Technical Description of JCRdb (Jena Clinical Research Database) v1.0</a><ul>
      <li>Previous: <a href="TechnicalDetails_Appendix_Concepts.html" title="previous chapter">Concepts predefined in the database</a></li>
      <li>Next: <a href="TechnicalDetails_Appendix_CQL.html" title="next chapter">CQL - Descriptions and example rules</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, sb.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/TechnicalDetails_Appendix_SQL.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>